:root {
  --pms-blue-900: #0f2f57;
  --pms-blue-700: #16508f;
  --pms-blue-500: #1677ff;
  --pms-bg: #eef3f9;
  --pms-surface: #ffffff;
  --pms-text: #1e2a38;
  --pms-border: #ccd8e6;
  --pms-shadow: 0 8px 24px rgba(15, 35, 60, 0.12);
  --pms-radius: 14px;
  --s-1: .5rem;
  --s-2: .75rem;
  --s-3: 1rem;
  --s-4: 1.5rem;
  --s-5: 2rem;
  --pms-layout-max: 1180px;
  --pms-layout-pad: 1rem;
  --pms-layout-gap: var(--s-3);
  --pms-header-offset: 0px;
}
* { box-sizing: border-box; }
body { margin: 0; font-family: system-ui, -apple-system, "Segoe UI", sans-serif; color: var(--pms-text); background: var(--pms-bg); line-height: 1.5; }
body, button, input, select, textarea { line-height: 1.5; }
h1,h2,h3 { line-height: 1.25; margin: 0 0 var(--s-2); color: #102845; }
p { margin: 0 0 var(--s-3); }
.pms-container,
.app-shell, .core-container, .workspace, main, .container, .container-grid {
  width: min(var(--pms-layout-max), calc(100% - (var(--pms-layout-pad) * 2)));
  margin-inline: auto;
}
.pms-stack {
  display: flex;
  flex-direction: column;
  gap: var(--pms-layout-gap);
}
.pms-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(min(250px, 100%), 1fr));
  gap: var(--pms-layout-gap);
  align-items: stretch;
}
.pms-section { margin-block: var(--s-4); }
.workspace { margin-block: var(--s-4) var(--s-5); }

.pms-cockpit {
  max-width: 1100px;
  margin: 0 auto;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
  gap: 24px;
}

.pms-panel {
  background: white;
  border-radius: 14px;
  padding: 20px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, .06);
  border: 1px solid rgba(0, 0, 0, .05);
  margin-bottom: 0;
}

.pms-panel .column-header {
  margin-bottom: var(--s-3);
}

.pms-panel .column-header h2 {
  font-size: 1.2rem;
  letter-spacing: .02em;
}

.pms-panel > * + * {
  margin-top: var(--s-3);
}

.core-header {
  background: linear-gradient(130deg, var(--pms-blue-900), var(--pms-blue-700));
  color: #fff;
  position: relative;
  z-index: 60;
}
.core-header-top { padding: var(--s-3) 0; }
.core-branding { display: flex; align-items: center; justify-content: space-between; gap: var(--s-3); min-height: 58px; }
.core-logo-rf, .core-logo-forpro { height: 54px; width: auto; }
.core-brand-text { text-align: center; }
.core-brand-text h1 { color: #fff; font-size: clamp(1.2rem, 2.5vw, 1.8rem); }
.core-kicker { margin: 0; font-size: .85rem; opacity: .9; }
.core-main-nav { border-top: 1px solid rgba(255,255,255,.2); border-bottom: 1px solid rgba(255,255,255,.2); }
.core-nav-wrap { display: flex; flex-wrap: wrap; gap: var(--s-1); padding: .55rem 0; }
.core-nav-link { text-decoration: none; color: #fff; border: 1px solid rgba(255,255,255,.45); border-radius: 999px; padding: .45rem .85rem; }
.core-nav-link.is-active { background: #fff; color: var(--pms-blue-900); font-weight: 700; }

.operator-nav { background: rgba(255,255,255,.96); border-bottom: 1px solid var(--pms-border); }
.operator-nav--top { position: sticky; top: var(--pms-header-offset); z-index: 50; box-shadow: 0 2px 10px rgba(15,35,60,.08); }
.operator-nav--bottom { border-top: 1px solid var(--pms-border); border-bottom: 0; margin-top: var(--s-4); }
.operator-nav .app-nav-wrap { display: flex; flex-wrap: wrap; gap: var(--s-2); padding: var(--s-2) 0; }

.card, .section-card, .content-bloc, .intro-card, .info-box, .box, .tool-card, .panel, .card-module, .card-section, .card-context, .card-actions, .result-box, .result-details {
  background: var(--pms-surface); border: 1px solid var(--pms-border); border-radius: var(--pms-radius); box-shadow: var(--pms-shadow); padding: var(--s-3); margin-bottom: var(--s-3);
}
.section-title, .column-header { display: flex; align-items: center; gap: var(--s-2); margin-bottom: var(--s-2); }
.card-actions, .action-buttons, .button-group, .tool-grid, .cards-grid, .section-grid, .listing-grid {
  display: flex;
  flex-wrap: wrap;
  align-items: stretch;
  gap: var(--s-2);
}

.pms-uniform-card,
.card,
.section-card,
.content-bloc,
.intro-card,
.info-box,
.box,
.tool-card,
.panel,
.card-module,
.card-section,
.card-context,
.card-actions,
.result-box,
.result-details,
.card-modern {
  height: 100%;
}

.btn, .btn-primary, .btn-secondary, .btn-ghost, button, a.btn {
  min-height: 44px;
  border-radius: 11px;
  border: 1px solid transparent;
  font-weight: 600;
  cursor: pointer;
  text-decoration: none;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: .45rem;
  padding: .6rem 1rem;
  line-height: 1.2;
}
.btn svg, button svg, .core-nav-link svg, .icon svg, .btn img, button img {
  width: 1em;
  height: 1em;
  vertical-align: middle;
  flex: 0 0 auto;
}
.btn > *, button > * {
  display: inline-flex;
  align-items: center;
}
.btn-primary { background: var(--pms-blue-500); color: #fff; }
.btn-secondary { background: #fff; color: var(--pms-blue-700); border-color: var(--pms-blue-700); }
.btn-ghost { background: #f5f8fc; color: var(--pms-text); border-color: var(--pms-border); }
.app-nav-btn.is-disabled { opacity: .5; pointer-events: none; }

label { display: block; font-weight: 600; margin-bottom: .4rem; }
input, select, textarea { width: 100%; min-height: 44px; border: 1px solid var(--pms-border); border-radius: 10px; padding: .6rem .75rem; background: #fff; }
.form-group, .audit-item { margin-bottom: var(--s-3); }

.table-wrap { overflow-x: auto; }
table { width: 100%; border-collapse: collapse; background: #fff; }
th, td { border: 1px solid var(--pms-border); padding: .6rem .7rem; }
thead th { position: sticky; top: 0; background: #eaf1fb; z-index: 1; }
tbody tr:nth-child(even) { background: #f8fbff; }

.context-visual { display: block; width: min(100%, 760px); margin: .75rem auto 0; height: auto; }
.context-visual[data-svg-fallback="true"] {
  background: linear-gradient(135deg, #f3f7fd, #e6eef9);
  border: 1px dashed var(--pms-border);
  border-radius: 10px;
  min-height: 120px;
  padding: var(--s-3);
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--pms-blue-700);
  font-weight: 600;
}

body.pms-has-sticky-top main,
body.pms-has-sticky-top .workspace,
body.pms-has-sticky-top .pms-main {
  scroll-margin-top: calc(var(--pms-header-offset) + 64px);
}

.floating-top { position: fixed; bottom: 1rem; min-width: 88px; min-height: 44px; border-radius: 999px; border: 1px solid #fff; background: var(--pms-blue-900); color: #fff; opacity: 0; pointer-events: none; transition: opacity .2s ease; z-index: 70; }
.floating-top--left { left: 1rem; }
.floating-top--right { right: 1rem; }
.floating-top.is-visible { opacity: 1; pointer-events: auto; }

html[data-nav="core"] .back-home,
html[data-nav="core"] .scroll-top,
html[data-nav="core"] .btn-scroll-left,
html[data-nav="core"] .btn-scroll-right,
html[data-nav="core"] .app-nav-bottom,
html[data-nav="core"] .legacy-nav,
html[data-nav="core"] .legacy-navigation,
html[data-nav="core"] .bottom-navigation,
html[data-nav="core"] .nav-buttons,
html[data-nav="core"] .navigation-links,
html[data-nav="core"] [data-nav-legacy] {
  display: none !important;
}
html[data-nav="core"] .core-header ~ .core-header,
html[data-nav="core"] .operator-nav--top ~ .operator-nav--top {
  display: none !important;
}

:focus-visible { outline: 3px solid rgba(22,119,255,.45); outline-offset: 2px; }

.core-footer { background: #1a2b3d; color: #fff; padding: var(--s-4) 0; }
.core-footer-content { display: flex; justify-content: space-between; align-items: center; gap: var(--s-3); flex-wrap: wrap; }
.core-footer-logos { display:flex; gap:var(--s-3); }
.core-footer-logo { height: 38px; filter: brightness(0) invert(1); }
.core-footer-info p { margin: .2rem 0; }
.core-footer-info a { color: #ffd89a; }

@media (max-width: 768px) {
  .core-branding { flex-direction: column; }
  .operator-nav .app-nav-wrap { flex-direction: column; }
  .operator-nav .app-nav-wrap > * { width: 100%; }
}
html[data-nav-core="1"] nav:not(.pms-op-nav):not(.pms-bottom-nav),
html[data-nav-core="1"] .legacy-nav,
html[data-nav-core="1"] .old-nav,
html[data-nav-core="1"] .nav-legacy {
  display: none !important;
}

/* Operator nav as contextual bar (NOT a sticky navbar) */
.pms-op-nav {
  position: relative;
  margin: 16px auto 18px;
  max-width: 1100px;
  padding: 8px 12px;
  background: #f7f9fb;
  border: 1px solid rgba(0,0,0,.06);
  border-radius: 12px;
  box-shadow: none;
}

.pms-op-nav .btn{
  min-height:36px;
  font-size:14px;
}

.pms-op-nav__inner {
  padding: 10px 16px;
  display: flex;
  gap: 12px;
  align-items: center;
  flex-wrap: wrap;
}

/* Bottom nav */
.pms-bottom-nav {
  position: sticky;
  bottom: 0;
  z-index: 40;
  background: rgba(255,255,255,0.96);
  border-top: 1px solid rgba(0,0,0,0.08);
}

.pms-bottom-nav__inner {
  max-width: 1100px;
  margin: 0 auto;
  padding: 10px 16px;
  display: flex;
  gap: 12px;
  align-items: center;
  justify-content: center;
  flex-wrap: wrap;
}

/* Float buttons */
.pms-float-btn {
  position: fixed;
  bottom: 22px;
  z-index: 60;
  opacity: 0;
  transform: translateY(6px);
  pointer-events: none;
  transition: opacity .15s ease, transform .15s ease;
}

.pms-float-btn--left { left: 18px; }
.pms-float-btn--right { right: 18px; }

.pms-float-btn.is-visible {
  opacity: 1;
  transform: translateY(0);
  pointer-events: auto;
}

/* Buttons alignment */
.btn, a.btn, button.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: .5rem;
  min-height: 44px;
}

/* SVG alignment */
svg {
  width: 1em;
  height: 1em;
  flex: 0 0 auto;
  vertical-align: middle;
}

/* Safe media fallback */
img.pms-media-broken {
  display: none !important;
}

.pms-media-fallback {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 1.25em;
  height: 1.25em;
  line-height: 1;
  font-size: 1em;
  vertical-align: middle;
  opacity: .75;
}

.pms-svg-empty {
  width: 1.25em !important;
  height: 1.25em !important;
}

/* ===============================
   PMS TMS-LIKE COMPOSITION
================================ */

:root{
  --pms-max:1120px;
  --pms-gap:24px;
  --pms-radius:14px;
  --pms-border:1px solid rgba(0,0,0,.06);
  --pms-shadow:0 10px 22px rgba(0,0,0,.06);
}

/* IMPORTANT:
   ne masquer QUE les anciennes nav explicites */
html[data-nav-core="1"] .legacy-nav,
html[data-nav-core="1"] .old-nav,
html[data-nav-core="1"] .nav-legacy,
html[data-nav-core="1"] [data-legacy-nav="1"]{
  display:none!important;
}

.pms-container{
  max-width:var(--pms-max);
  margin:0 auto;
  padding:0 16px;
}

/* ===== CONTEXTE SESSION ===== */

.pms-kpi{
  display:flex;
  flex-wrap:wrap;
  gap:12px;
  padding:14px;
  margin:12px 0 24px;
  border:none;
  border-radius:var(--pms-radius);
  background:#eef3f8;
  box-shadow:0 2px 10px rgba(0,0,0,.04);
}

.pms-kpi__item{
  display:flex;
  gap:8px;
  font-size:13px;
}

.pms-kpi__k{opacity:.7}
.pms-kpi__v{font-weight:800}

/* ===== COCKPIT GRID ===== */

.pms-cockpit{
  display:grid;
  grid-template-columns:
    repeat(auto-fit,minmax(320px,1fr));
  gap:var(--pms-gap);
  margin:28px 0 40px;
}

/* ===== PANELS ===== */

.pms-panel{
  background:#fff;
  border:var(--pms-border);
  border-radius:var(--pms-radius);
  box-shadow:var(--pms-shadow);
  padding:16px;
  gap:6px;
  display:flex;
  flex-direction:column;
  border-left:4px solid #1f4e79;
}

.pms-panel__title{
  font-size:18px;
  font-weight:900;
  margin-bottom:6px;
}

.pms-panel__sub{
  font-size:14px;
  opacity:.8;
  margin-bottom:14px;
}

/* ===== LISTE MODULE ===== */

.pms-list{
  list-style:none;
  padding:0;
  margin:0;
  display:flex;
  flex-direction:column;
  gap:12px;
}

.pms-item{
  border:1px solid rgba(0,0,0,.06);
  border-radius:12px;
  padding:12px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  min-height:64px;
}

.pms-item > div{
  flex:1;
}

.pms-item__name{
  font-weight:800;
  margin:0;
}

.pms-item__desc{
  font-size:13px;
  opacity:.75;
}

.pms-tags{
  display:flex;
  gap:6px;
  margin-top:6px;
}

.pms-tag{
  font-size:12px;
  padding:2px 8px;
  border-radius:999px;
  border:1px solid rgba(0,0,0,.08);
  background:#f3f5f7;
}

/* ===== CTA ===== */

a.pms-btn{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding:10px 14px;
  border-radius:12px;
  border:1px solid rgba(0,0,0,.1);
  text-decoration:none;
  font-weight:800;
  white-space:nowrap;
}


/* ===== PMS TMS-LIKE COMPOSITION + DENSITY PASS ===== */
:root{
  --pms-max:1120px;
  --pms-gap:24px;
  --pms-radius:14px;
  --pms-border:1px solid rgba(0,0,0,.06);
  --pms-shadow:0 10px 22px rgba(0,0,0,.06);
}

/* IMPORTANT: ne masquer QUE legacy explicite (ne pas casser nav internes du cours) */
html[data-nav-core="1"] .legacy-nav,
html[data-nav-core="1"] .old-nav,
html[data-nav-core="1"] .nav-legacy,
html[data-nav-core="1"] [data-legacy-nav="1"]{
  display:none!important;
}

/* Conteneur cockpit */
.pms-container{ max-width:var(--pms-max); margin:0 auto; padding:0 16px; }

/* Alléger barre opérateur (si elle utilise .pms-op-nav) */
.pms-op-nav{
  margin: 12px auto 18px;
  max-width: var(--pms-max);
  background:#f7f9fb;
  border: var(--pms-border);
  box-shadow:none;
}
.pms-op-nav__inner{ padding:8px 12px; }
.pms-op-nav .btn{ min-height:36px; font-size:14px; }

/* KPI context bar */
.pms-kpi{
  display:flex; flex-wrap:wrap; gap:10px 14px;
  padding:12px 14px;
  border-radius: var(--pms-radius);
  background:#eef3f8;
  border:none;
  margin: 12px 0 24px;
}
.pms-kpi__item{ display:flex; gap:8px; align-items:baseline; font-size:13px; }
.pms-kpi__k{ opacity:.7; }
.pms-kpi__v{ font-weight:900; }

/* Cockpit grid */
.pms-cockpit{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(320px,1fr));
  gap:var(--pms-gap);
  margin: 0 0 40px;
}

/* Panels */
.pms-panel{
  background:#fff;
  border:var(--pms-border);
  border-left:4px solid #1f4e79; /* ancrage TMS */
  border-radius:var(--pms-radius);
  box-shadow:var(--pms-shadow);
  padding:16px;
  display:flex;
  flex-direction:column;
  gap:6px;
}
.pms-panel__title{ font-size:18px; font-weight:950; margin:0 0 6px; }
.pms-panel__sub{ font-size:14px; opacity:.82; margin:0 0 12px; }

/* Items */
.pms-list{ list-style:none; padding:0; margin:0; display:flex; flex-direction:column; gap:12px; }
.pms-item{
  border:1px solid rgba(0,0,0,.06);
  border-radius:12px;
  padding:12px;
  display:flex;
  justify-content:space-between;
  align-items:center;            /* align CTA */
  gap:12px;
  min-height:64px;              /* densité stable */
}
.pms-item__meta{ flex:1; min-width:0; }
.pms-item__name{ font-weight:900; margin:0; }
.pms-item__desc{ font-size:13px; opacity:.75; margin:4px 0 0; }

a.pms-btn{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding:10px 14px;
  border-radius:12px;
  border:1px solid rgba(0,0,0,.10);
  text-decoration:none;
  font-weight:900;
  white-space:nowrap;
}

/* Option: rendre les liens internes moins "violets" si déjà un style global existe.
   Ne pas casser le DS existant: pas de reset global. */
